!function(){function e(e){var t=this;t.client_=e,t.action_="",s("conferenceModalDiv").style.width="300px",s("conferenceModal").style.display="block",s("conferenceModalClose").addEventListener("click",t.hide),s("conferenceModalDelete").addEventListener("click",t.handleDelete.bind(t)),s("conferenceModalForm").onsubmit=function(e){e.preventDefault(),t.handleOK()}}function t(t){this.guest_=t,this.client_=new WebRtcClient(window.location.hostname,this.eventHandler.bind(this)),this.client_.setCanvases(s("mainFormCanvas"),s("mainFormCanvas2")),this.remoteStream_=[];var n=this;window.addEventListener("message",n.messageHandler.bind(n),!1),this.presenting_=!1,this.recording_=!1,this.shareName_="",this.selfView_=!0,this.talkerList_=[],this.names_=[],this.positions_=[],this.grid_=!1,this.captions_=!1,this.shape_="pencil",this.selectUnselectBtn(this.shape_,!1),this.wnd_=[],this.maxDisplays_=6,this.callTimer_=null,this.callTime_=0,t||(this.conferenceModal_=new e(this.client_))}var n=null,a=16,i=9,o=function(){for(var e=window.location.search.substring(1),t=e.split("&"),n={},a=0;a<t.length;a++){var i=t[a].split("=");n[i[0]]=i[1]}return n},s=function(e){var t=document.getElementById(e);return t||console.error("INVALID ELEMENT "+e),t},l=function(e,t){var n=document.getElementById(e);n&&(n.style.display=t)},r=function(e){var t=s(e);-1===t.className.indexOf("modal-show")&&(t.className=t.className+" modal-show")},c=function(e){var t=s(e),n=t.className.replace(/ *modal-show */," ");t.className=n};e.prototype.getConf=function(){var e={id:this.id_,name:s("conferenceModalName").value,autoRecord:s("conferenceModalRecord").checked,maxBitrateKbps:s("conferenceModalBandwidth").value};return e},e.prototype.handleDelete=function(e){window.confirm("Delete this conference ?")?this.action_="DELETE":e.preventDefault()},e.prototype.handleOK=function(){switch(this.action_){case"ADD":this.client_.addConference(this.getConf(),function(e){alert("Conference "+e.conf.name+" add status - "+e.status+" conf id - "+e.conf.id)});break;case"EDIT":this.client_.modifyConference(this.getConf(),function(e){alert("Conference "+s("conferenceModalName").value+" modify status - "+e.status)});break;case"DELETE":this.client_.deleteConference(this.getConf(),function(e){alert("Conference "+s("conferenceModalName").value+" delete status - "+e.status)});break;default:console.error("UNHANDLED ACTION IN CONFERENCE MODAL - "+this.action_)}this.id_=void 0,this.hide()},e.prototype.setAction=function(e){this.action_=e},e.prototype.setTitle=function(e){s("conferenceModalHeader").innerHTML=e},e.prototype.setName=function(e){s("conferenceModalName").value=e},e.prototype.setRecord=function(e){s("conferenceModalRecord").checked=e},e.prototype.setBandwidth=function(e){for(var t=["256","512","768","1024","auto"],n=0;n<t.length;n++)if(t[n]===e)return void(s("conferenceModalBandwidth").selectedIndex=n);s("conferenceModalBandwidth").selectedIndex=t.length-1},e.prototype.setButton=function(e){s("conferenceModalOK").innerHTML=e},e.prototype.showHideDelete=function(e){e?s("conferenceModalDelete").style.display="inline-block":s("conferenceModalDelete").style.display="none"},e.prototype.show=function(){r("conferenceModal")},e.prototype.hide=function(){c("conferenceModal")},e.prototype.showAddConference=function(){this.setTitle("Add Conference"),this.setName(""),this.setRecord(!1),this.setBandwidth("auto"),this.setButton("ADD"),this.setAction("ADD"),this.showHideDelete(!1),this.show()},e.prototype.showEditConference=function(e){this.id_=e.id,this.setTitle("Edit Conference"),this.setName(e.name),this.setRecord(e.autoRecord),this.setBandwidth(e.maxBitrateKbps),this.setButton("SAVE"),this.setAction("EDIT"),this.showHideDelete(!0),this.show()},t.prototype.reset=function(){this.localStream_=null,this.remoteStream_.length=0,this.presenting_=!1,this.recording_=!1,this.shareName_="",this.selfView_=!0,this.hideVideo(),this.talkerList_.length=0,this.names_.length=0,this.positions_.length=0;for(var e=0;e<this.wnd_.length;e++)this.wnd_[e].close();this.wnd_.length=0,this.grid_=!1,this.captions_=!1,s("mainFormRemoteCaption").style.display="none";var t=s("mainFormVideoBtn");for(t.className=t.className.replace("video-mute","video-unmute"),t=s("mainFormMicrophoneBtn"),t.className=t.className.replace("mic-mute","mic-unmute"),t=s("mainFormSpeakerBtn"),t.className=t.className.replace("speaker-mute","speaker-unmute"),s("mainFormRecordBtn").style.opacity=.5,s("mainFormShareBtn").style.opacity=.5,s("mainFormDisplaysBtn").style.display="inline-block",s("mainFormShareBtn").style.display="inline-block",s("mainFormRaiseHandBtn").style.opacity=.5,s("mainFormRaiseHandBtn").style.display="none",this.hideShareVideo(),this.guest_?(s("mainDiv").style.display="none",s("signInDiv").style.display="block"):(this.hideIncomingCall(),this.hideMakeCall()),this.callTimer_&&(clearInterval(this.callTimer_),this.callTimer_=null),this.callTime_=0,s("mainFormRemoteVideo1").src="",s("mainFormRecordInd").style.display="none",s("mainFormSelfVideoMuteImg").style.display="none",s("mainFormRemoteVideoMuteImg").style.display="none",s("mainFormShareName").innerHTML="",this.setVideoPosition(s("mainFormShareVideo"),{top:0,left:0,height:0,width:0}),e=1;e<=this.maxDisplays_;e++){var n=s("mainFormVideo"+e);this.setVideoPosition(n,{top:0,left:0,height:0,width:0}),s("mainFormRemotePart"+e).innerHTML=""}};var d=function(e){console.log((new Date).toISOString()+" - App: ",e)};t.prototype.messageHandler=function(e){if(e.origin===window.location.origin){var t=e.data;switch(d("MsgHandler: "+JSON.stringify(t)),t.type){case"windowOpened":var n=URL.createObjectURL(this.remoteStream_[t.videoNo]);this.wnd_[t.videoNo-1].postMessage({type:"remoteStream",video:n,name:this.names_[t.videoNo-1]},window.location.origin);break;case"windowClosed":}}},t.prototype.eventHandler=function(e){switch(d("Event: "+JSON.stringify(e)),e.type){case"voiceCallRequest":this.showIncomingCall(e.id,"Voice",e.name);break;case"videoCallRequest":this.showIncomingCall(e.id,"Video",e.name);break;case"callAnswered":this.hideIncomingCall();break;case"disconnectCallRequest":this.hideIncomingCall(),this.showModal("Missed call from "+s("callModal").dataset.username,!0,!0,"OK");break;case"contactUpdated":var t=s(e.id);t&&(t.getElementsByClassName("contact-status")[0].innerHTML=e.status);break;case"conferenceUpdated":s(e.id).getElementsByClassName("conference-status")[0].innerHTML=e.status;break;case"recordingsUpdated":s("mainFormRecordingsBody").innerHTML="",this.fetchRecordings();break;case"conferencesUpdated":s("mainFormContactsList").innerHTML="",s("mainFormConferencesList").innerHTML="",s("mainFormConferencesBody").innerHTML="",this.fetchContactsAndRecordings(!1);break;case"userJoined":this.showModal(""+e.userName+' joined your conference room "'+e.confName+'"',!0,!1,"");break;case"userLeft":this.showModal(""+e.userName+' left your conference room "'+e.confName+'"',!0,!1,"");break;case"connectionClosed":this.showModal("Connection to Server lost",!0,!1,""),this.reset(),s("mainFormContactsList").innerHTML="",s("mainFormConferencesList").innerHTML="",s("mainFormConferencesBody").innerHTML="",s("mainFormRecordingsBody").innerHTML="",s("mainDiv").style.display="none",s("signInDiv").style.display="block"}},t.prototype.showModal=function(e,t,a,i,o){var l=this;d("showModal - "+e);var c=s("genericModal");if(-1!==c.className.indexOf("modal-show")){var m=s("genericModalText").innerHTML+"<br><hr>"+e;s("genericModalText").innerHTML=m}else s("genericModalText").innerHTML=e;t?s("genericModalClose").style.display="block":s("genericModalClose").style.display="none",n&&s("genericModalCancel").removeEventListener("click",n),a?(s("genericModalCancel").innerHTML=i,o?(n=o,s("genericModalCancel").addEventListener("click",o)):(n=l.hideGenericModal.bind(l),s("genericModalCancel").addEventListener("click",n)),s("genericModalCancel").style.display="inline-block",s("genericModalFooter").style.display="block"):(s("genericModalCancel").style.display="none",s("genericModalFooter").style.display="none"),r("genericModal")},t.prototype.hideGenericModal=function(){c("genericModal")},t.prototype.addContacts=function(e){for(var t=this,n=function(e){t.contactClicked(this)},a=function(e){console.dir(e),t.conferenceClicked(this)},i=function(e){console.dir(e),t.conferenceClicked(s(e.target.dataset.id))},o=function(e){var n=e.target.dataset,a={id:n.id,name:n.name,autoRecord:"true"===n.autoRecord?!0:!1,maxBitrateKbps:n.maxBitrateKbps};t.conferenceModal_.showEditConference(a)},l=s("mainFormContactsList"),r=s("mainFormConferencesList"),c=0;c<e.length;c++)if("user"===e[c].type){var d=document.createElement("li");d.id=e[c].id,d.className="contact";var m='<p class="contact-name list-name">';m+=e[c].name,m+="</p>",m+='<p class="contact-status list-status">',m+=e[c].status,m+="</p>",d.innerHTML=m,d.addEventListener("click",n),l.appendChild(d)}else if("self"===e[c].type){var h=document.createElement("tr"),p="<td>Direct Call</td>";p+="<td>"+window.location.protocol+"//"+window.location.hostname+"/guest.html?userId="+e[c].id+"</td>",p+='<td colspan=5 style="height: 45px;">Use this link for direct guest calling</td>',h.innerHTML=p,s("mainFormConferencesBody").appendChild(h)}else if(-1===this.id_.indexOf(e[c].userId)){var d=document.createElement("li");d.id=e[c].id,d.className="conference";var m='<p class="conference-name list-name">';m+=e[c].name,m+="</p>",m+='<p class="conference-status list-status">',m+=e[c].status,m+="</p>",d.innerHTML=m,d.addEventListener("click",a),r.appendChild(d)}else{var h=document.createElement("tr");h.id=e[c].id;var p='<td class="conference-name">'+e[c].name+"</td>";p+="<td>"+window.location.protocol+"//"+window.location.hostname+"/guest.html?conferenceId="+e[c].id+"</td>",p+='<td class="conference-status">'+e[c].status+"</td>",p+=e[c].autoRecord?"<td> Yes </td>":"<td> No </td>",p+="auto"!==e[c].maxBitrateKbps?"<td>"+e[c].maxBitrateKbps+" kbps </td>":"<td> Auto </td>",p+='<td><button class="voice-call"></button></td>',p+='<td><button class="edit"></button></td>',h.innerHTML=p;var u=h.getElementsByTagName("button");u[0].dataset.id=e[c].id,u[0].onclick=i,u[1].dataset.id=e[c].id,u[1].dataset.name=e[c].name,u[1].dataset.autoRecord=e[c].autoRecord,u[1].dataset.maxBitrateKbps=e[c].maxBitrateKbps,u[1].onclick=o,s("mainFormConferencesBody").appendChild(h)}},t.prototype.contactClicked=function(e){console.dir(e);var t=s(e.id).getElementsByClassName("contact-name")[0].innerHTML;d("Name is "+t),this.showMakeCall(e.id,t,"Call ","call")},t.prototype.conferenceClicked=function(e){console.dir(e);var t=s(e.id).getElementsByClassName("conference-name")[0].innerHTML;d("Name is "+t),this.showMakeCall(e.id,t,"Join Conference - ","conference")},t.prototype.showAddConference=function(){this.conferenceModal_.showAddConference()},t.prototype.addRecordings=function(e){for(var t=function(e){var t="/player.html?video="+e.target.dataset.path;window.open(t,"_blank")},n=function(e){window.confirm("Delete this recording ?")&&a.client_.deleteRecording(e.target.dataset.path)},a=this,i=0;i<e.length;i++){var o=document.createElement("tr"),l=new Date(e[i].startTime),r=window.location.protocol+"//"+window.location.hostname+"/player.html?video="+e[i].path,c='<td class="conference-name">'+e[i].confName+"</td>";c+="<td>"+l.toLocaleString()+"</td>",c+="<td>"+r+"</td>",c+='<td><button class="view"></button></td>',c+='<td><button class="delete"></button></td>',o.innerHTML=c;var d=o.getElementsByTagName("button");d[0].dataset.path=e[i].path,d[0].onclick=t,d[1].dataset.path=e[i].path,d[1].onclick=n,s("mainFormRecordingsBody").appendChild(o)}},t.prototype.setVideoTitle=function(e){s("mainFormTitle").innerHTML=e,s("mainFormTime").innerHTML="( 00:00 )"},t.prototype.updateCallTime=function(){this.callTime_+=1;var e=Math.floor(this.callTime_/60);10>e&&(e="0"+e);var t=this.callTime_%60;10>t&&(t="0"+t);var n=Math.floor(e/60),a=n>0?""+n+":":"";a+=e+":"+t,s("mainFormTime").innerHTML=" ( "+a+" )"},t.prototype.showMakeCall=function(e,t,n,a){s("callModalText").innerHTML=n+" "+t,s("callModal").dataset.userid=e,s("callModal").dataset.username=t,s("callModal").dataset.callOrConference=a,r("callModal")},t.prototype.hideMakeCall=function(){c("callModal")},t.prototype.showIncomingCall=function(e,t,n){s("incomingCallModalText").innerHTML="Incoming "+t+" Call from "+n,s("incomingCallModal").dataset.callType=t,s("incomingCallModal").dataset.userid=e,s("callModal").dataset.username=n,s("callModal").dataset.callOrConference="call",s("callModal").dataset.callType=t,r("incomingCallModal"),this.setVideoTitle(n)},t.prototype.hideIncomingCall=function(){c("incomingCallModal")},t.prototype.rejectCall=function(){s("incomingCallModal").dataset.userid;d("Reject Call called"),this.client_.rejectCall(),this.hideIncomingCall()},t.prototype.ignoreCall=function(){s("incomingCallModal").dataset.userid;d("Ignore Call called"),this.client_.ignoreCall(),this.hideIncomingCall()},t.prototype.answerCall=function(){var e=this;s("incomingCallModal").dataset.userid,s("incomingCallModal").dataset.username;d("Answer Call called"),e.hideIncomingCall(),e.showModal("Call Proceeding...",!1,!0,"HANG UP",e.hangup.bind(e)),e.client_.answerCall(s("incomingCallModal").dataset.callType,e.callCallback.bind(e))},t.prototype.showHideSelfView=function(){var e=s("mainFormSelfView");if(!this.selfView_)return void(e.style.display="none");var t=s("mainFormVideosContainer"),n=t.clientWidth,o=t.clientHeight,l=Math.floor(.7*o),r=o-l,c=Math.floor(r*a/i),d=n-c;this.setVideoPosition(e,{top:l,left:d,width:c,height:r}),e.style.display="block"},t.prototype.setupForVideo=function(){d("Setting up for video max="+this.maxDisplays_+"  current="+this.currentDisplays_);for(var e="call"===s("callModal").dataset.callOrConference,t=s("mainFormDisplaysBtn"),n=t.length,a=0;n>a;a++)t.remove(0);for(var i,o=0;o<this.maxDisplays_;o++)i=document.createElement("option"),i.value=o+1,i.text=o+1,t.add(i);t.selectedIndex=this.currentDisplays_-1,this.hideGenericModal(),l("mainFormConferencesAndRecordings","none"),this.callTimer_=setInterval(this.updateCallTime.bind(this),1e3),this.videoLayout(this.talkerList_,this.names_),e?(this.guest_?s("mainFormTransferBtn").style.display="none":s("mainFormTransferBtn").style.display="inline-block",s("mainFormDisplaysBtn").style.display="none",s("mainFormRecordBtn").style.display="none",s("mainFormLayoutBtn").style.display="none",s("mainFormParticipants").style.display="none"):(this.guest_?s("mainFormRecordBtn").style.display="none":s("mainFormRecordBtn").style.display="inline-block",s("mainFormTransferBtn").style.display="none",s("mainFormLayoutBtn").style.display="inline-block",l("mainFormConferencesAndRecordings","none"),l("mainFormcontactsAndConferences","none"),s("mainFormParticipants").style.display="block"),s("mainFormVideos").style.display="block",this.showHideSelfView()},t.prototype.showVideo=function(e){d("Remote Stream Index: "+e.index+" id: "+e.id+" label: "+e.label);var t=s("mainFormRemoteVideo"+e.index);t&&(t.src="",this.remoteStream_[e.index]=e.stream,attachMediaStream(t,e.stream),1===e.index&&(s("mainFormVideo"+e.index).style.display="block"))},t.prototype.hideVideo=function(){for(var e=1;e<=this.maxDisplays_;++e)s("mainFormVideo"+e).style.display="none",s("mainFormRemoteVideo"+e).src="";s("mainFormVideos").style.display="none",this.closeChat(),this.clearChat(),l("mainFormcontactsAndConferences","block"),l("mainFormConferencesAndRecordings","block"),s("mainFormParticipants").style.display="none"},t.prototype.fetchContactsAndRecordings=function(e){var t=this;t.showModal("Fetching contacts...",!1,!1,""),t.client_.getContacts(function(n){t.addContacts(n),e?t.fetchRecordings():t.hideGenericModal()})},t.prototype.fetchRecordings=function(){var e=this;e.showModal("Fetching recordings...",!1,!1,""),e.client_.getRecordings(function(t){e.addRecordings(t),e.hideGenericModal()})},t.prototype.login=function(){var e=this,t=e.callCallback.bind(e);if(e.guest_){var n=s("inputText").value,a=s("callModal").dataset.callType,i=o();return void(i.hasOwnProperty("conferenceId")?(e.showModal("Joining the conference..."),s("callModal").dataset.callOrConference="conference",e.client_.guestLogin(n,i.conferenceId,function(n){0===n.status?(e.maxDisplays_=n.maxDisplays,e.currentDisplays_=n.currentDisplays,s("signInDiv").style.display="none",s("mainDiv").style.display="block",e.id_=n.id,e.hideGenericModal(),e.showModal("Making "+a+" call to "+n.confName+"...",!1,!0,"HANG UP",e.hangup.bind(e)),e.setVideoTitle(n.confName),"Voice"===a?e.client_.joinVoiceConference(i.conferenceId,t):e.client_.joinVideoConference(i.conferenceId,t)):(e.hideGenericModal(),e.showModal("Failed - "+n.status,!0,!1,""))})):i.hasOwnProperty("userId")?(s("callModal").dataset.callOrConference="call",e.client_.createGuestUser(n,function(n){return 0!==n.status?void e.showModal("Failed - "+n.status,!0,!1,""):(e.maxDisplays_=n.maxDisplays,e.currentDisplays_=n.currentDisplays,s("signInDiv").style.display="none",s("mainDiv").style.display="block",e.id_=n.id,void e.client_.joinGuestRoom(i.userId,a,t))})):(s("callModal").dataset.callOrConference="call",e.client_.createGuestUser(n,function(a){if(0!==a.status)return void e.showModal("Failed - "+a.status,!0,!1,"");e.maxDisplays_=a.maxDisplays,e.currentDisplays_=a.currentDisplays,s("signInDiv").style.display="none",s("mainDiv").style.display="block",e.id_=a.id,s("callModal").dataset.username=n,e.client_.waitInGuestRoom(t),e.setupForVideo();var i="Copy and send this link to invite (Press Ctrl+C / Cmd+C) <br> <br> ",o=""+window.location.protocol+"//"+window.location.hostname+"/guest.html?userId="+e.id_;i+='<input type="text" id="modalTextBox" value="'+o+'">',e.showModal(i),s("modalTextBox").select()})))}var l=s("inputEmail").value,r=s("inputPassword").value;e.showModal("Logging in...",!1,!1,""),s("inputRememberMe").checked&&(window.localStorage.email=l,window.localStorage.passwd=r),e.client_.login(l,r,function(t){0===t.status?(e.maxDisplays_=t.maxDisplays,e.currentDisplays_=t.currentDisplays,s("signInDiv").style.display="none",s("mainDiv").style.display="block",e.id_=t.id,e.fetchContactsAndRecordings(!0)):(e.hideGenericModal(),e.showModal("Login failed - "+t.status,!0,!1,""))})},t.prototype.callCallback=function(e){var t,n,a=this,i=!1,o=!1,l=s("callModal");switch(t=l.dataset.username,i="call"===l.dataset.callOrConference,o="Voice"===l.dataset.callType,e.type){case"userUnavailableResponse":this.guest_?(a.reset(),a.showModal("Invalid guest room...",!0,!0,"OK")):a.showModal("User Unavailable",!0,!0,"OK");break;case"callProceeding":a.showModal("Call Proceeding...",!1,!0,"HANG UP",a.hangup.bind(a));break;case"rejectCallResponse":this.guest_?a.showModal("Room full...",!0,!0,"OK"):a.showModal("Call Rejected...",!0,!0,"OK"),a.reset();break;case"ignoreCallResponse":a.showModal("Call Ignored...",!0,!0,"OK"),a.reset();break;case"videoConfResponse":0!==e.status&&(a.showModal("Conference full",!0,!0,"OK"),a.reset());break;case"licenseStatus":a.reset(),a.showModal("License check failed - "+e.status,!0,!0,"OK");break;case"disconnectConfResponse":a.reset(),a.showModal("Call Disconnected",!0,!0,"OK");break;case"getUserMediaFailed":a.reset(),a.showModal("Camera/Microphone access failed",!0,!0,"OK");break;case"acceptCallResponse":a.showModal("Collecting Capabilities...",!1,!0,"HANG UP",a.hangup.bind(a));break;case"remoteGuestUser":a.hideGenericModal(),a.showModal('"'+e.guestName+'" joined'),s("callModal").dataset.username=e.guestName,a.setVideoTitle(e.guestName);break;case"offerSdp":a.showModal("Negotiating Capabilities...",!1,!0,"HANG UP",a.hangup.bind(a));break;case"remoteAudioStream":attachMediaStream(s("mainFormAudio1"),e.stream),i&&(a.setupForVideo(),a.names_=[t],a.talkerList_=[0],a.videoLayout(a.talkerList_,a.names_));break;case"remoteStream":1===e.index&&a.setupForVideo(),a.showVideo(e),i&&(a.names_=[t],a.talkerList_=[1]),a.names_.length>0&&a.videoLayout(a.talkerList_,a.names_);break;case"localStream":var r=s("mainFormSelfVideo");r.src="",a.localStream_=e.stream,attachMediaStream(s("mainFormSelfVideo"),e.stream);break;case"userFilesTransferRequest":case"confFilesTransferRequest":this.downloadFile(e.files);break;case"userChatMessage":case"confChatMessage":this.openChat(),this.addChat(e.chat,e.name);break;case"remoteShareStream":attachMediaStream(s("mainFormShareVideo1"),e.stream),this.showShareVideo(e.shareName);break;case"userStopShare":case"confStopShare":this.hideShareVideo();break;case"userAudioMuted":case"userAudioUnmuted":break;case"userVideoMuted":s("mainFormRemoteVideoMuteImg").style.display="block";break;case"userVideoUnmuted":s("mainFormRemoteVideoMuteImg").style.display="none";break;case"confAudioForceMuted":case"userAudioForceMuted":n=s("mainFormMicrophoneBtn"),n.className=n.className.replace("mic-unmute","mic-mute"),n.disabled=!0;break;case"confAudioForceUnmuted":case"userAudioForceUnmuted":n=s("mainFormMicrophoneBtn"),n.className=n.className.replace("mic-mute","mic-unmute"),n.disabled=!1;break;case"confVideoForceMuted":case"userVideoForceMuted":n=s("mainFormVideoBtn"),n.className=n.className.replace("video-unmute","video-mute"),s("mainFormSelfVideoMuteImg").style.display="block",n.disabled=!0;break;case"confVideoForceUnmuted":case"userVideoForceUnmuted":n=s("mainFormVideoBtn"),n.className=n.className.replace("video-mute","video-unmute"),s("mainFormSelfVideoMuteImg").style.display="none",n.disabled=!1;break;case"confModeChanged":switch(e.mode){case"groupModeParticipant":case"presenterModePresenter":"groupModeParticipant"===e.mode?s("mainFormConferenceMode").innerHTML="(GROUP MODE)":s("mainFormConferenceMode").innerHTML="(PRESENTER)",n=s("mainFormMicrophoneBtn"),n.className=n.className.replace("mic-mute","mic-unmute"),n.disabled=!1,s("mainFormRaiseHandBtn").style.display="none",s("mainFormDisplaysBtn").style.display="inline-block",s("mainFormShareBtn").style.display="inline-block";break;case"presenterModeParticipant":s("mainFormConferenceMode").innerHTML="(LISTENER)",n=s("mainFormMicrophoneBtn"),n.className=n.className.replace("mic-unmute","mic-mute"),n.disabled=!0,s("mainFormRaiseHandBtn").style.display="inline-block",s("mainFormDisplaysBtn").style.display="none",s("mainFormShareBtn").style.display="none"}break;case"confRaiseHandResponse":e.audioUnmuted&&(n=s("mainFormMicrophoneBtn"),n.className=n.className.replace("mic-mute","mic-unmute"),n.disabled=!1),s("mainFormRaiseHandBtn").style.opacity=.5;break;case"disconnectCallRequest":this.showModal("Call Disconnected...",!0,!0,"OK"),this.reset();break;case"conferenceEnded":this.showModal("Conference ended...",!0,!0,"OK"),this.reset(),s("mainFormRemoteVideo1").src="";break;case"userCaption":case"confCaption":var l=s("mainFormRemoteCaption");l.style.display="block",l.innerHTML=e.caption;break;case"activeTalkerList":var c=e.talkers.map(function(e){return e.videoNo}),m=(this.talkerList_.length,e.talkers.map(function(e){return e.name}));this.videoLayout(c,m),this.setActiveTalker(m[0]);break;case"callTransferInProgress":this.hideGenericModal(),this.showModal("Transferring Call...",!1,!1,"");break;case"recordingStarted":s("mainFormRecordInd").style.display="inline";break;case"recordingStopped":s("mainFormRecordInd").style.display="none";break;case"participantsUpdated":var h=s("mainFormParticipantsList");h.innerHTML="";for(var p=0;p<e.participants.length;p++){var u=document.createElement("li"),f="list-name nospeaker";this.names_[0]===e.participants[p].name&&(f="list-name speaker");var y='<p class="'+f+'">'+e.participants[p].name+"</p>";y+="Video"===e.participants[p].callType?'<span class="video-call callicon"></span>':'<span class="voice-call callicon"></span>',u.innerHTML=y,h.appendChild(u)}break;default:d("UNHANDLED MESSAGE IN CALL CALLBACK "+e.type)}},t.prototype.voiceCall=function(){var e=this;s("callModal").dataset.callType="Voice";var t=s("callModal").dataset.userid,n=s("callModal").dataset.username,a=s("callModal").dataset.callOrConference;d("Voice call - "+n+"  "+t),e.hideMakeCall(),e.showModal("Making Voice call to "+n+"...",!1,!0,"HANG UP",e.hangup.bind(e));var i=e.callCallback.bind(e);"conference"===a?(e.setVideoTitle(n),e.client_.joinVoiceConference(t,i)):(e.setVideoTitle(n),e.client_.makeVoiceCall(t,i))},t.prototype.videoCall=function(){var e=this;s("callModal").dataset.callType="Video";var t=s("callModal").dataset.userid,n=s("callModal").dataset.username,a=s("callModal").dataset.callOrConference;d("Video call - "+n+"  "+t),e.hideMakeCall(),e.showModal("Making Video call to "+n+"...",!1,!0,"HANG UP",e.hangup.bind(e));var i=e.callCallback.bind(e);"conference"===a?(e.setVideoTitle(n),e.client_.joinVideoConference(t,i)):(e.setVideoTitle(n),e.client_.makeVideoCall(t,i))},t.prototype.raiseHand=function(e){s("mainFormRaiseHandBtn").style.opacity=1,this.client_.raiseHand()},t.prototype.callTransfer=function(e){this.client_.transferCall()},t.prototype.maxDisplays=function(e){if("call"!==s("callModal").dataset.callOrConference){for(var t=parseInt(s("mainFormDisplaysBtn").value,10),n=this.positions_,a=[],i=0;t>i;i++){var o,l;n[i]?(o=n[i].width,l=n[i].height):o=l=0,d("W["+(i+1)+"]   w="+o+"  h="+l),a.push({width:o,height:l})}this.client_.setCurrentDisplays(t,a)}},t.prototype.record=function(e){var t=this;t.recording_===!1?(t.recording_=!0,s("mainFormRecordBtn").style.opacity=1,t.client_.startRecording(function(){})):(s("mainFormRecordBtn").style.opacity=.5,t.client_.stopRecording(function(){t.recording_=!1}))},t.prototype.selectUnselectBtn=function(e,t){t?s("mainForm"+e+"Btn").style.opacity="0.5":s("mainForm"+e+"Btn").style.opacity="1.0"},t.prototype.selectColor=function(e){var t=s("mainFormColorBtn").value,n=s("mainFormWidth").value;this.client_.setWhiteboardShape(this.shape_,t,n)},t.prototype.selectLineWidth=function(e){var t=s("mainFormColorBtn").value,n=s("mainFormWidth").value;this.client_.setWhiteboardShape(this.shape_,t,n)},t.prototype.selectPencil=function(e){var t=s("mainFormColorBtn").value,n=s("mainFormWidth").value;this.selectUnselectBtn(this.shape_,!0),this.shape_="pencil",this.selectUnselectBtn(this.shape_,!1),this.client_.setWhiteboardShape("pencil",t,n)},t.prototype.selectLine=function(e){var t=s("mainFormColorBtn").value,n=s("mainFormWidth").value;this.selectUnselectBtn(this.shape_,!0),this.shape_="line",this.selectUnselectBtn(this.shape_,!1),this.client_.setWhiteboardShape("line",t,n)},t.prototype.selectRectangle=function(e){var t=s("mainFormColorBtn").value,n=s("mainFormWidth").value;this.selectUnselectBtn(this.shape_,!0),this.shape_="rectangle",this.selectUnselectBtn(this.shape_,!1),this.client_.setWhiteboardShape("rectangle",t,n)},t.prototype.selectCircle=function(e){var t=s("mainFormColorBtn").value,n=s("mainFormWidth").value;this.selectUnselectBtn(this.shape_,!0),this.shape_="circle",this.selectUnselectBtn(this.shape_,!1),this.client_.setWhiteboardShape("circle",t,n)},t.prototype.selectEraser=function(e){var t=s("mainFormColorBtn").value,n=s("mainFormWidth").value;this.selectUnselectBtn(this.shape_,!0),this.shape_="eraser",this.selectUnselectBtn(this.shape_,!1),this.client_.setWhiteboardShape("eraser",t,n)},t.prototype.saveSnapshot=function(e){var t=s("mainFormcaptureBtn"),n=s("mainFormShareVideo1"),a=document.createElement("canvas"),i=a.getContext("2d");a.height=n.videoHeight,a.width=n.videoWidth,i.drawImage(n,0,0),i.drawImage(s("mainFormCanvas"),0,0,a.width,a.height);var o=a.toDataURL("image/jpeg",1);t.download="Snapshot_"+(new Date).toLocaleString().replace(/,? /g,"_")+".jpeg",t.href=o},t.prototype.whiteboard=function(e){var t=s("mainFormDrawButtonGroup");"none"===t.style.display?t.style.display="block":t.style.display="none"},t.prototype.toggleCaption=function(e){this.captions_?(this.captions_=!1,this.client_.stopCaptions()):(this.captions_=!0,this.client_.startCaptions())},t.prototype.redrawLayout=function(e){this.videoLayout(this.talkerList_,this.names_),this.showHideSelfView()},t.prototype.toggleLayout=function(){this.grid_=!this.grid_,this.redrawLayout()},t.prototype.showHideFullScreenElements=function(e){e?"call"===s("callModal").dataset.callOrConference?l("mainFormcontactsAndConferences","block"):s("mainFormParticipants").style.display="block":(l("mainFormcontactsAndConferences","none"),s("mainFormParticipants").style.display="none",s("mainFormChat").style.display="none")},t.prototype.requestFullScreen=function(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen(),this.showHideFullScreenElements(!1)},t.prototype.exitFullScreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),this.showHideFullScreenElements(!0)},t.prototype.fullScreenChange=function(){var e=s("mainFormFullScreenBtn");document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement?(e.className=e.className.replace("fullscreen","normalscreen"),this.showHideFullScreenElements(!1)):(e.className=e.className.replace("normalscreen","fullscreen"),this.showHideFullScreenElements(!0))},t.prototype.toggleFullScreen=function(){var e=s("mainFormFullScreenBtn");-1!==e.className.indexOf("fullscreen")?(e.className=e.className.replace("fullscreen","normalscreen"),this.requestFullScreen(document.body)):(e.className=e.className.replace("normalscreen","fullscreen"),this.exitFullScreen())},t.prototype.toggleVideo=function(){var e=s("mainFormVideoBtn");-1!==e.className.indexOf("video-unmute")?(e.className=e.className.replace("video-unmute","video-mute"),this.client_.muteVideo(),s("mainFormSelfVideoMuteImg").style.display="block"):(e.className=e.className.replace("video-mute","video-unmute"),this.client_.unmuteVideo(),s("mainFormSelfVideoMuteImg").style.display="none")},t.prototype.toggleMic=function(){var e=s("mainFormMicrophoneBtn");-1!==e.className.indexOf("mic-unmute")?(e.className=e.className.replace("mic-unmute","mic-mute"),this.client_.muteMicrophone()):(e.className=e.className.replace("mic-mute","mic-unmute"),this.client_.unmuteMicrophone())},t.prototype.toggleSpeaker=function(){var e=s("mainFormSpeakerBtn");-1!==e.className.indexOf("speaker-unmute")?(e.className=e.className.replace("speaker-unmute","speaker-mute"),this.client_.muteSpeaker(),s("mainFormRemoteVideo1").volume=0):(e.className=e.className.replace("speaker-mute","speaker-unmute"),this.client_.unmuteSpeaker(),s("mainFormRemoteVideo1").volume=1)},t.prototype.showShareVideo=function(e){this.shareName_=e,this.videoLayout(this.talkerList_,this.names_)},t.prototype.hideShareVideo=function(){this.shareName_="",this.videoLayout(this.talkerList_,this.names_),s("mainFormDrawButtonGroup").style.display="none",s("mainFormColorBtn").value="#ff0000",this.selectUnselectBtn(this.shape_,!0),this.shape_="pencil",this.selectUnselectBtn(this.shape_,!1)},t.prototype.setVideoPosition=function(e,t){e.style.top=t.top+"px",e.style.left=t.left+"px",e.style.width=t.width+"px",e.style.height=t.height+"px"},t.prototype.getPositions=function(e){if(0>=e)return[];var t,n;if(this.grid_)switch(e){case 1:t=n=1;break;case 2:t=1,n=2;break;case 3:case 4:t=n=2;break;case 5:case 6:t=2,n=3;break;case 7:case 8:case 9:t=3,n=3}else switch(e){case 1:n=t=1;break;default:n=e,t=e-1}var o,l,r=a*n/(i*t),c=s("mainFormVideosContainer"),d=c.clientWidth,m=c.clientHeight,h=d/m,p=0,u=0;h>r?(l=m,o=d*r/h,p=Math.floor((d-o)/2)):(o=d,l=m*h/r,u=Math.floor((m-l)/2));var f=Math.floor(o/n),y=Math.floor(l/t),g=[];if(this.grid_){for(var v=0,M=0;t>M;M++)for(var C=0;n>C;C++){var F={};if(F.top=y*M+u,F.left=f*C+p,F.width=f,F.height=y,g.push(F),v++,v==e)break}3==e?g[2].left+=f/2:5==e&&(g[3].left+=f/2,g[4].left+=f/2)}else{var F={};F.top=u,F.left=p,F.height=y*t,F.width=n>1?f*(n-1):f,g.push(F);for(var b=1;e>b;b++){var F={};F.top=(b-1)*y+u,F.left=f*(n-1)+p,F.height=y,F.width=f,g.push(F)}}return g},t.prototype.videoLayout=function(e,t){
if(this.talkerList_=e,this.names_=t,!(this.talkerList_.length<=0)){for(var n=e.length,a=0,i=0;n>i;i++)this.talkerList_[i]>0&&(a+=1);this.shareName_.length>0&&(a+=1);var o=!1;0===a&&(a=1,o=!0);var l=this.getPositions(a),r=s("mainFormShareVideo"),c=s("mainFormCanvas");this.shareName_.length>0?(s("mainFormShareName").innerHTML=this.shareName_,this.setVideoPosition(r,l[0]),l[0].top=0,l[0].left=0,this.setVideoPosition(c,l[0]),r.style.display="block",this.client_.resizeCanvas(r.offsetWidth,r.offsetHeight),l=l.slice(1)):r.style.display="none";var d,m=[1,0,0,0,0,0,0],h=0;for(d=0;n>d&&d<this.maxDisplays_;d++){var p=this.talkerList_[d];if(0===p){if(!o)continue;p=1,s("mainFormRemoteVideo1").load()}if(l[h]){var u=s("mainFormVideo"+p);this.setVideoPosition(u,l[h++]),u.style.display="block",m[p]=1,s("mainFormRemotePart"+p).innerHTML=t[d]}}for(d=1;d<=this.maxDisplays_;d++)if(0===m[d]){var u=s("mainFormVideo"+d);u.style.display="none",s("mainFormRemotePart"+d).innerHTML=""}var f=!1;if(this.positions_.length!==l.length)f=!0;else for(var y=0;y<l.length;y++)if(l[y].width!=this.positions_[y].width||l[y].height!=this.positions_[y].height){f=!0;break}f&&(this.positions_=l,this.maxDisplays())}},t.prototype.setActiveTalker=function(e){for(var t=s("mainFormParticipantsList").getElementsByClassName("list-name"),n=0;n<t.length;n++)t[n].innerHTML===e?t[n].className="list-name speaker":t[n].className="list-name nospeaker"},t.prototype.startShare=function(e){var t=this,n=function(){s("mainFormShareBtn").style.opacity=.5,t.client_.stopShare(function(e){t.hideShareVideo(),s("mainFormShareVideo1").src="",t.presenting_=!1})};t.presenting_===!1?t.client_.isShareEnabled(function(e){if(!e){var a="To start sharing - ";return a+="<a href='https://chrome.google.com/webstore/detail/socialvid-webrtc-share/bjhmiolgijcdfhdjlgpdaofbbdlpefmc' target='_blank'>Install Extension</a>",void t.showModal(a,!0,!0,"OK")}t.client_.startShare(function(e){switch(e.type){case"localShareStream":s("mainFormShareBtn").style.opacity=1,attachMediaStream(s("mainFormShareVideo1"),e.stream),t.showShareVideo("Me"),t.presenting_=!0;break;case"localShareStreamEnded":n();break;case"shareOffer":}})}):n()},t.prototype.openChat=function(e){l("mainFormcontactsAndConferences","none"),s("mainFormParticipants").style.display="none",s("mainFormChat").style.display="block",s("mainFormChatText").focus()},t.prototype.closeChat=function(){s("mainFormChat").style.display="none","call"===s("callModal").dataset.callOrConference?l("mainFormcontactsAndConferences","block"):s("mainFormParticipants").style.display="block"},t.prototype.clearChat=function(){s("mainFormChatsList").innerHTML=""},t.prototype.addChat=function(e,t){var n=!1,a="left",i="right";void 0===t&&(n=!0,t="You",a="right",i="left");var o=new Date,l=o.getHours()+":"+(o.getMinutes()<=9?"0"+o.getMinutes():o.getMinutes()),r=document.createElement("li");r.innerHTML='<p style="text-align: '+a+';"><b>'+t+'</b></p><p style="text-align: '+a+';">'+e+'</p><p style="text-align: '+i+'; font-size: 85%;">'+l+"</p>",s("mainFormChatsList").appendChild(r),s("mainFormChatsList").scrollTop=s("mainFormChatsList").scrollHeight},t.prototype.sendChat=function(){var e=s("mainFormChatText").value;this.addChat(e),this.client_.sendChat(e),s("mainFormChatText").value=""},t.prototype.transferFile=function(e){s("fileTransferModalHeader").innerHTML="Transfer File(s)",s("fileTransferModalProgress").style.display="none",s("fileTransferModalFileInput").style.display="inline-block",s("fileTransferModalFileDrop").style.display="inline-block",s("fileTransferModalUpload").style.display="inline-block",s("fileTransferModalCancel").innerHTML="Cancel",s("fileTransferModalFileInput").value="",s("fileTransferModalProgress").getElementsByTagName("progress")[0].value=0,s("fileTransferModalProgress").style.display="none",s("fileTranferModalIncomingFiles").style.display="none",r("fileTransferModal")},t.prototype.hideFileTransfer=function(){c("fileTransferModal")},t.prototype.fileDragHover=function(e){e.stopPropagation(),e.preventDefault()},t.prototype.fileSelectHandler=function(e){this.fileDragHover(e);var t=e.target.files||e.dataTransfer.files;this.sendFilesToServer(t)},t.prototype.uploadFiles=function(){this.sendFilesToServer(s("fileTransferModalFileInput").files)},t.prototype.sendFilesToServer=function(e){s("fileTransferModalProgress").style.display="block",s("fileTransferModalFileInput").style.display="none",s("fileTransferModalFileDrop").style.display="none",s("fileTransferModalProgress").style.display="block";var t=s("fileTransferModalProgress").getElementsByTagName("progress")[0];this.client_.uploadFiles(e,function(e){switch(e.type){case"progress":t.value=e.percent,d(" PROGRESS: "+e.percent);break;case"status":s("fileTransferModalUpload").style.display="none",s("fileTransferModalCancel").innerHTML="OK"}})},t.prototype.downloadFile=function(e){s("fileTransferModalHeader").innerHTML="Download File(s)",s("fileTransferModalProgress").style.display="none",s("fileTransferModalFileInput").style.display="none",s("fileTransferModalFileDrop").style.display="none",s("fileTransferModalUpload").style.display="none",s("fileTransferModalCancel").innerHTML="OK",s("fileTransferModalFileInput").value="",s("fileTransferModalProgress").getElementsByTagName("progress")[0].value=0;for(var t=this,n=0;n<e.length;n++){var a=e[n],i=document.createElement("a");i.href="#",i.innerHTML=a,i.addEventListener("click",function(){t.client_.downloadFile(a)}),s("fileTranferModalIncomingFiles").appendChild(i),s("fileTranferModalIncomingFiles").appendChild(document.createElement("br"))}s("fileTranferModalIncomingFiles").style.display="block",r("fileTransferModal")},t.prototype.selfView=function(e){var t=s("mainFormSelfView");this.selfView_?(t.style.display="none",this.selfView_=!1):(t.style.display="block",this.selfView_=!0)},t.prototype.popOut=function(e){for(var t=0;t<this.talkerList_.length;t++){var n=screen.height/3,a=screen.width/3,i="height="+n+", width="+a+", ";i+="scrollbars=no, location=no, directories=no, status=no, menubar=no, toolbar=no, resizable=no, dependent=no, alwaysRaised=yes",d("Using "+a+"x"+n+" "+i),this.wnd_[t]=window.open("/video.html?video="+(t+1),this.names_[t],i)}},t.prototype.hangup=function(e){var t=this;t.showModal("Disconnecting call...",!1,!1,""),t.client_.disconnectCall(function(){t.showModal("Call Disconnected...",!0,!0,"OK"),t.reset()}),e.stopPropagation(),e.preventDefault()},window.onload=function(){var e=!1;"/guest.html"===window.location.pathname&&(e=!0);var n=new t(e);window.webrtcApp=n,e?window.localStorage.guestName&&(s("inputText").value=window.localStorage.guestName):window.localStorage.email&&(s("inputEmail").value=window.localStorage.email,s("inputPassword").value=window.localStorage.passwd),s("signInForm").onsubmit=function(e){e.preventDefault(),s("callModal").dataset.callType="Video",n.login()},s("genericModal").style.display="block",s("fileTransferModal").style.display="block",s("genericModalClose").addEventListener("click",function(){n.hideGenericModal()}),e?(s("inputSubmitVoice").disabled=!1,s("inputSubmitVoice").addEventListener("click",function(e){e.preventDefault(),s("callModal").dataset.callType="Voice",n.login()})):(s("callModal").style.display="block",s("incomingCallModal").style.display="block",s("callModalClose").addEventListener("click",function(){c("callModal")}),s("callModalCancel").addEventListener("click",function(){c("callModal")}),s("callModalVoiceCall").addEventListener("click",n.voiceCall.bind(n)),s("callModalVideoCall").addEventListener("click",n.videoCall.bind(n)),s("incomingCallModalRejectCall").addEventListener("click",n.rejectCall.bind(n)),s("incomingCallModalAnswerCall").addEventListener("click",n.answerCall.bind(n)),s("incomingCallModalIgnore").addEventListener("click",n.ignoreCall.bind(n)),s("incomingCallModalClose").addEventListener("click",n.ignoreCall.bind(n)),s("mainFormConferencesAdd").addEventListener("click",n.showAddConference.bind(n))),s("mainFormRaiseHandBtn").style.display="none",s("mainFormDrawButtonGroup").style.display="none",s("mainFormColorBtn").addEventListener("change",n.selectColor.bind(n)),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(s("mainFormColorBtn").style.height="45px"),s("mainFormWidth").addEventListener("change",n.selectColor.bind(n)),s("mainFormpencilBtn").addEventListener("click",n.selectPencil.bind(n)),s("mainFormlineBtn").addEventListener("click",n.selectLine.bind(n)),s("mainFormrectangleBtn").addEventListener("click",n.selectRectangle.bind(n)),s("mainFormcircleBtn").addEventListener("click",n.selectCircle.bind(n)),s("mainFormeraserBtn").addEventListener("click",n.selectEraser.bind(n)),s("mainFormcaptureBtn").addEventListener("click",n.saveSnapshot.bind(n)),s("mainFormRaiseHandBtn").addEventListener("click",n.raiseHand.bind(n)),s("mainFormTransferBtn").addEventListener("click",n.callTransfer.bind(n)),s("mainFormDisplaysBtn").addEventListener("change",n.maxDisplays.bind(n)),s("mainFormRecordBtn").addEventListener("click",n.record.bind(n)),s("mainFormWhiteboardBtn").addEventListener("click",n.whiteboard.bind(n)),s("mainFormLayoutBtn").addEventListener("click",n.toggleLayout.bind(n)),s("mainFormFullScreenBtn").addEventListener("click",n.toggleFullScreen.bind(n)),s("mainFormVideoBtn").addEventListener("click",n.toggleVideo.bind(n)),s("mainFormMicrophoneBtn").addEventListener("click",n.toggleMic.bind(n)),s("mainFormSpeakerBtn").addEventListener("click",n.toggleSpeaker.bind(n)),s("mainFormShareBtn").addEventListener("click",n.startShare.bind(n)),s("mainFormChatBtn").addEventListener("click",n.openChat.bind(n)),s("mainFormFileTransferBtn").addEventListener("click",n.transferFile.bind(n)),s("mainFormSelfViewBtn").addEventListener("click",n.selfView.bind(n)),s("mainFormPopoutBtn").addEventListener("click",n.popOut.bind(n)),s("mainFormHangupBtn").addEventListener("click",n.hangup.bind(n)),s("fileTransferModalBody").addEventListener("dragover",n.fileDragHover.bind(n)),s("fileTransferModalBody").addEventListener("dragleave",n.fileDragHover.bind(n)),s("fileTransferModalBody").addEventListener("drop",n.fileSelectHandler.bind(n)),s("fileTransferModalUpload").addEventListener("click",n.uploadFiles.bind(n)),s("fileTransferModalClose").addEventListener("click",n.hideFileTransfer.bind(n)),s("fileTransferModalCancel").addEventListener("click",n.hideFileTransfer.bind(n)),s("mainFormChatText").addEventListener("keydown",function(e){13===e.keyCode&&(e.preventDefault(),s("mainFormChatSubmit").click())}),s("mainFormChatCloseBtn").addEventListener("click",n.closeChat.bind(n)),s("mainFormChatForm").addEventListener("submit",function(e){n.sendChat(),e.preventDefault()}),document.addEventListener("fullscreenchange",n.fullScreenChange.bind(n)),document.addEventListener("webkitfullscreenchange",n.fullScreenChange.bind(n)),document.addEventListener("mozfullscreenchange",n.fullScreenChange.bind(n)),document.addEventListener("MSFullscreenChange",n.fullScreenChange.bind(n)),window.addEventListener("resize",n.redrawLayout.bind(n)),window.addEventListener("keydown",function(e){27===e.keyCode&&n.hideGenericModal()});var a=document.getElementsByClassName("call-button-group")[0],i=setTimeout(function(){},100);s("mainFormVideosContainer").addEventListener("mousemove",function(e){clearTimeout(i),a.style.bottom="5px",i=setTimeout(function(){a.style.bottom="-150px"},3e3)}),s("inputSubmit").disabled=!1}}();